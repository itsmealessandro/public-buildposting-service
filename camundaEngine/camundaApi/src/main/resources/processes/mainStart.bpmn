<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:modeler="http://camunda.org/schema/modeler/1.0" id="Definitions_02xv82i" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.33.1" modeler:executionPlatform="Camunda Platform" modeler:executionPlatformVersion="7.19.0">
  <bpmn:message id="Message_1bdvnss" name="message-1" />
  <bpmn:message id="Message_1u8rev1" name="client_request" />
  <bpmn:collaboration id="Collaboration_0hlqsz8">
    <bpmn:participant id="Participant_07xbar8" name="camunda" processRef="mainProcessID" />
    <bpmn:participant id="Participant_0oaetem" name="Client" processRef="Process_0d55huw" />
    <bpmn:participant id="Participant_0j40oos" name="user-WS" processRef="Process_132boto" />
    <bpmn:participant id="Participant_1gsuhvu" name="ZONES-WS" processRef="Process_05dkfd0" />
    <bpmn:participant id="Participant_0znlog7" name="POSTING-WS" processRef="Process_04k4fp4" />
    <bpmn:messageFlow id="Flow_0r55hbz" sourceRef="Participant_0oaetem" targetRef="requestReceivedID" />
    <bpmn:messageFlow id="Flow_1ilekpa" sourceRef="userDataID" targetRef="Participant_0j40oos" />
    <bpmn:messageFlow id="Flow_1r24u7i" sourceRef="Participant_0j40oos" targetRef="userDataID" />
    <bpmn:messageFlow id="Flow_1dw54oo" sourceRef="postingservice" targetRef="Participant_0znlog7" />
    <bpmn:messageFlow id="Flow_1yim0z8" sourceRef="postingservice" targetRef="Participant_0oaetem" />
    <bpmn:messageFlow id="Flow_0v3ykcq" sourceRef="Participant_0znlog7" targetRef="postingservice" />
    <bpmn:messageFlow id="Flow_0c4yk7e" sourceRef="Getzoneslist" targetRef="Participant_1gsuhvu" />
    <bpmn:messageFlow id="Flow_1oe3yei" sourceRef="Participant_1gsuhvu" targetRef="Getzoneslist" />
  </bpmn:collaboration>
  <bpmn:process id="mainProcessID" name="mainProcess" isExecutable="true" camunda:historyTimeToLive="1">
    <bpmn:extensionElements />
    <bpmn:sequenceFlow id="Flow_1ogqmdf" sourceRef="postingservice" targetRef="Activity_1s4owrj" />
    <bpmn:sequenceFlow id="Flow_0r6igyt" sourceRef="Getzoneslist" targetRef="selectzones" />
    <bpmn:sequenceFlow id="Flow_131otxq" sourceRef="selectzones" targetRef="Gateway_join0" />
    <bpmn:sequenceFlow id="Flow_1355dzx" sourceRef="Gateway_parallel0" targetRef="Getzoneslist" />
    <bpmn:sequenceFlow id="Flow_1udpmuu" sourceRef="Gateway_parallel0" targetRef="userDataID" />
    <bpmn:sequenceFlow id="Flow_1lwnvwi" sourceRef="requestReceivedID" targetRef="Gateway_parallel0" />
    <bpmn:serviceTask id="selectzones" name="select zones" camunda:class="com.example.service.delegate.SelectZonesDelegate">
      <bpmn:incoming>Flow_0r6igyt</bpmn:incoming>
      <bpmn:outgoing>Flow_131otxq</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Getzoneslist" name="Get zones list">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">http://zones-service:9090/zones/${format}</camunda:inputParameter>
            <camunda:inputParameter name="method">GET</camunda:inputParameter>
            <camunda:outputParameter name="zones">${response}</camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1355dzx</bpmn:incoming>
      <bpmn:outgoing>Flow_0r6igyt</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="userDataID" name="Retrieve user data info">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">http://user-service:9080/user/${username}</camunda:inputParameter>
            <camunda:inputParameter name="method">GET</camunda:inputParameter>
            <camunda:outputParameter name="user_info">${response}</camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_1udpmuu</bpmn:incoming>
      <bpmn:outgoing>Flow_0t92dta</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:parallelGateway id="Gateway_join0">
      <bpmn:incoming>Flow_131otxq</bpmn:incoming>
      <bpmn:incoming>Flow_1tbwuiv</bpmn:incoming>
      <bpmn:outgoing>Flow_16onrkw</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:startEvent id="requestReceivedID" name="requestReceived">
      <bpmn:outgoing>Flow_1lwnvwi</bpmn:outgoing>
      <bpmn:messageEventDefinition id="MessageEventDefinition_1solnja" messageRef="Message_1u8rev1" />
    </bpmn:startEvent>
    <bpmn:parallelGateway id="Gateway_parallel0" name="gateway">
      <bpmn:incoming>Flow_1lwnvwi</bpmn:incoming>
      <bpmn:outgoing>Flow_1udpmuu</bpmn:outgoing>
      <bpmn:outgoing>Flow_1355dzx</bpmn:outgoing>
    </bpmn:parallelGateway>
    <bpmn:sequenceFlow id="Flow_0t92dta" sourceRef="userDataID" targetRef="Activity_0mjrp8p" />
    <bpmn:sequenceFlow id="Flow_1tbwuiv" sourceRef="Activity_0mjrp8p" targetRef="Gateway_join0" />
    <bpmn:serviceTask id="Activity_0mjrp8p" name="UserDataConversion" camunda:class="com.example.service.delegate.UserDataConversionDelegate">
      <bpmn:incoming>Flow_0t92dta</bpmn:incoming>
      <bpmn:outgoing>Flow_1tbwuiv</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="Flow_16onrkw" sourceRef="Gateway_join0" targetRef="postingservice" />
    <bpmn:intermediateCatchEvent id="Event_0g9hzsk">
      <bpmn:incoming>Flow_0r0zr7f</bpmn:incoming>
      <bpmn:messageEventDefinition id="MessageEventDefinition_1degu5x" messageRef="Message_1u8rev1" />
    </bpmn:intermediateCatchEvent>
    <bpmn:sequenceFlow id="Flow_0r0zr7f" sourceRef="Activity_1s4owrj" targetRef="Event_0g9hzsk" />
    <bpmn:serviceTask id="postingservice" name="posting service">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">http://posting-service:8888/postingservice</camunda:inputParameter>
            <camunda:inputParameter name="payload">
              <camunda:script scriptFormat="freemarker" resource="xmlFreemarker/availabilityRequest.ftl" />
            </camunda:inputParameter>
            <camunda:outputParameter name="availabilityResponse">${response}</camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>soap-http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>Flow_16onrkw</bpmn:incoming>
      <bpmn:outgoing>Flow_1ogqmdf</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:serviceTask id="Activity_1s4owrj" name="PrintPostingResponse" camunda:class="com.example.service.delegate.AvailabilityResponseDelegate">
      <bpmn:incoming>Flow_1ogqmdf</bpmn:incoming>
      <bpmn:outgoing>Flow_0r0zr7f</bpmn:outgoing>
    </bpmn:serviceTask>
  </bpmn:process>
  <bpmn:process id="Process_0d55huw" isExecutable="false" />
  <bpmn:process id="Process_132boto" isExecutable="false">
    <bpmn:laneSet id="LaneSet_1eqaggm" />
  </bpmn:process>
  <bpmn:process id="Process_05dkfd0" isExecutable="false">
    <bpmn:laneSet id="LaneSet_1aglcve" />
  </bpmn:process>
  <bpmn:process id="Process_04k4fp4" isExecutable="false">
    <bpmn:laneSet id="LaneSet_1bpf8og" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_0hlqsz8">
      <bpmndi:BPMNShape id="Participant_07xbar8_di" bpmnElement="Participant_07xbar8" isHorizontal="true">
        <dc:Bounds x="161" y="310" width="1419" height="530" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_157nfh2_di" bpmnElement="selectzones">
        <dc:Bounds x="710" y="440" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_183tac2" bpmnElement="Getzoneslist">
        <dc:Bounds x="560" y="440" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_06j4v6c_di" bpmnElement="userDataID">
        <dc:Bounds x="560" y="640" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0acvefa_di" bpmnElement="Gateway_join0">
        <dc:Bounds x="875" y="455" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="610" y="110" width="21" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_0lp93rq_di" bpmnElement="requestReceivedID">
        <dc:Bounds x="212" y="552" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="189" y="595" width="83" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_00bluz9_di" bpmnElement="Gateway_parallel0">
        <dc:Bounds x="475" y="545" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="535" y="563" width="42" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1odhx5d" bpmnElement="Activity_0mjrp8p">
        <dc:Bounds x="770" y="650" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Event_1uxzfia_di" bpmnElement="Event_0g9hzsk">
        <dc:Bounds x="1322" y="582" width="36" height="36" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1e0lexm" bpmnElement="postingservice">
        <dc:Bounds x="990" y="440" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_0ktw8mt" bpmnElement="Activity_1s4owrj">
        <dc:Bounds x="1000" y="560" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_1ogqmdf_di" bpmnElement="Flow_1ogqmdf">
        <di:waypoint x="1000" y="520" />
        <di:waypoint x="1000" y="540" />
        <di:waypoint x="1070" y="540" />
        <di:waypoint x="1070" y="560" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0r6igyt_di" bpmnElement="Flow_0r6igyt">
        <di:waypoint x="660" y="480" />
        <di:waypoint x="710" y="480" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_131otxq_di" bpmnElement="Flow_131otxq">
        <di:waypoint x="810" y="480" />
        <di:waypoint x="875" y="480" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1355dzx_di" bpmnElement="Flow_1355dzx">
        <di:waypoint x="500" y="545" />
        <di:waypoint x="500" y="480" />
        <di:waypoint x="560" y="480" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1udpmuu_di" bpmnElement="Flow_1udpmuu">
        <di:waypoint x="500" y="595" />
        <di:waypoint x="500" y="650" />
        <di:waypoint x="560" y="650" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1lwnvwi_di" bpmnElement="Flow_1lwnvwi">
        <di:waypoint x="248" y="570" />
        <di:waypoint x="475" y="570" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0t92dta_di" bpmnElement="Flow_0t92dta">
        <di:waypoint x="660" y="680" />
        <di:waypoint x="720" y="680" />
        <di:waypoint x="720" y="720" />
        <di:waypoint x="770" y="720" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1tbwuiv_di" bpmnElement="Flow_1tbwuiv">
        <di:waypoint x="870" y="690" />
        <di:waypoint x="900" y="690" />
        <di:waypoint x="900" y="505" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_16onrkw_di" bpmnElement="Flow_16onrkw">
        <di:waypoint x="925" y="480" />
        <di:waypoint x="990" y="480" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0r0zr7f_di" bpmnElement="Flow_0r0zr7f">
        <di:waypoint x="1100" y="600" />
        <di:waypoint x="1322" y="600" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Participant_0oaetem_di" bpmnElement="Participant_0oaetem" isHorizontal="true">
        <dc:Bounds x="160" y="80" width="1030" height="90" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_054hxvv" bpmnElement="Participant_0j40oos" isHorizontal="true">
        <dc:Bounds x="220" y="862" width="300" height="90" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_1ddb0rc" bpmnElement="Participant_1gsuhvu" isHorizontal="true">
        <dc:Bounds x="330" y="190" width="300" height="90" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="BPMNShape_13g8jzb" bpmnElement="Participant_0znlog7" isHorizontal="true">
        <dc:Bounds x="1061" y="190" width="300" height="90" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Flow_0r55hbz_di" bpmnElement="Flow_0r55hbz">
        <di:waypoint x="230" y="170" />
        <di:waypoint x="230" y="552" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ilekpa_di" bpmnElement="Flow_1ilekpa">
        <di:waypoint x="610" y="720" />
        <di:waypoint x="610" y="781" />
        <di:waypoint x="360" y="781" />
        <di:waypoint x="360" y="862" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1r24u7i_di" bpmnElement="Flow_1r24u7i">
        <di:waypoint x="520" y="907" />
        <di:waypoint x="630" y="907" />
        <di:waypoint x="630" y="720" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1dw54oo_di" bpmnElement="Flow_1dw54oo">
        <di:waypoint x="1040" y="440" />
        <di:waypoint x="1040" y="360" />
        <di:waypoint x="1120" y="360" />
        <di:waypoint x="1120" y="280" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1yim0z8_di" bpmnElement="Flow_1yim0z8">
        <di:waypoint x="1040" y="440" />
        <di:waypoint x="1040" y="170" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0v3ykcq_di" bpmnElement="Flow_0v3ykcq">
        <di:waypoint x="1080" y="280" />
        <di:waypoint x="1080" y="440" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0c4yk7e_di" bpmnElement="Flow_0c4yk7e">
        <di:waypoint x="560" y="480" />
        <di:waypoint x="390" y="480" />
        <di:waypoint x="390" y="280" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1oe3yei_di" bpmnElement="Flow_1oe3yei">
        <di:waypoint x="610" y="280" />
        <di:waypoint x="610" y="440" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>